<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸŽ„ Live Kerst Scoreboard ðŸŽ„</title>
<style>
    body {
        background-color: red;
        font-family: 'Comic Sans MS', cursive, sans-serif;
        text-align: center;
        padding-top: 50px;
        color: yellow;
    }
    .scorebox {
        background: #8b0000;
        border: 5px solid yellow;
        padding: 40px;
        font-size: 3rem;
        color: green;
        box-shadow: 0 0 30px yellow;
        animation: glow 3s alternate infinite;
    }
    @keyframes glow {
        from { box-shadow: 0 0 10px #ff0; }
        to   { box-shadow: 0 0 40px #ff0; }
    }
</style>
</head>
<body>

<h1>ðŸŽ„ Kerst Scoreboard ðŸŽ„</h1>
<div id="scoreDisplay" class="scorebox">Laden...</div>

<!-- Supabase JavaScript SDK -->
<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

const SUPABASE_URL = "https://itmhwyamdcdcompixnrk.supabase.co"
const SUPABASE_ANON_KEY = "sb_publishable_lun6Mhjl_0P4vqQNaPGyKw_OKNwJ9cW"

// maak Supabase client aan
const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

// DOM element
const scoreDisplay = document.getElementById("scoreDisplay")

// functie om score uit DB te halen
async function loadScore() {
    const { data, error } = await supabase
        .from("scoreboard")            // jouw tabelnaam
        .select("score")               // kolom met score
        .order("id", { ascending: false })
        .limit(1)

    if (error) {
        scoreDisplay.innerText = "âš ï¸ FOUT"
        console.error(error)
    } else {
        scoreDisplay.innerText = data.length ? data[0].score : "0"
    }
}

// realtime luisteren
supabase
  .channel('realtime-score')
  .on('postgres_changes', { event: '*', schema: 'public', table: 'scoreboard' }, payload => {
      console.log("Realtime update ontvangen:", payload)
      if(payload.new) {
          scoreDisplay.innerText = payload.new.score
      }
  })
  .subscribe()

// eerste keer score ophalen
loadScore()
</script>

</body>
</html>
